# DendriteAnalysis16bit
[![DOI](https://zenodo.org/badge/634958639.svg)](https://zenodo.org/badge/latestdoi/634958639)

This has been developed from a previous macro based on one from Dr. Dai Ling at Harvard in 2015. This macro is used to assess density and overlap of puncta along a dendrite. It takes MAX projected isolated dendrite ROI images and chosen thresholds to output the density, area, and colocalization of pre- and post- synaptic markers. This specific macro has been modified for use with 16bit images.

Images should be ROI selections of dendritic lengths from original 16-bit max projection images. It requires very specific formatting – the blue channel must be a tracer for the dendrite itself (i.e. MAP2 or a fill); the green and red channels are the ones that will be analyzed for puncta. Pre-format your images accordingly, and organize as followed:
	Channel 1 (Named "Red" in analysis): Synaptic marker or signal of interest for quantification
 	Channel 2 (Named "Green" in analysis): Synaptic marker or signal of interest for quantification
	Channel 3 (Named "Blue" in analysis): Dendritic selection or fill
 
The requirements to run the macro include:
	A folder with the dendrite images in subfolders by condition (Referred to as "Starting Images")
 	Length measurements of the dendritic selections (Best obtained when creating the ROI selection). The macro auto generates an approximate length, however after examination, these traces are often inaccurate. You should therefore record and save manually-obtained lengths for your images, and replace them within the "summary.xls" during data analysis.
	An empty folder for the dendrite traces produced by the macro (Referred to as "Masks")
 An empty folder for the results, auto populates with subfolders for each condition (Referred to as "Results") Upon running the macro, this folder will contain condition subfolders mirroring the "Starting Image" folder as well as a “summary.xls” sheet with generated data. The subfolders will contain ROI and masks generated by the macro for each image in the condition as well as a .xls files with the areas of the green and red puncta.
 Thresholds for the green and red channel. These should be determined by obtaining an average appropriate threshold from the control condition.
 
 In starting the macro, you will be prompted to select your Starting Image, Results, and Mask folders.
You then will be prompted to enter parameters for your analysis:
	Thresholds for Red and Green channels
 	Area % for determining colocalization of two puncta (Default is at least 25% of how much overlap of an ROI with a mask to be considered colocalized)
	Pixel scale (um/pixel), based on the starting image (check image properties)
	Max and min puncta size (pixels) This allows you to limit puncta identification for selection and analysis within a particular size range
 
The macro will then run automatically, opening and processing files. The most common error is due to the starting image folder, in which the images are not organized by condition. Another possible error may be due to not having the "Results" window open prior to running the macro.

Once complete, for data analysis you will open the “summary.xls” sheet located in the results folder. Data will include:
	Puncta Densities: Green, Red, Green coloc with Red, and Red coloc with Green (Identified as Density_G(#/um), Density_R(#/um), Density_GR(#/um), & Density_RG(#/um)) NOTE: Substitute in the manually measured lengths and re-calculate the densities. Counts should be (#puncta/length)*10 to get puncta per 10um as a measurement.
 	Puncta Size: These data are located within the nested results folders. Each condition will have its own .xls files "CONDITION_GreenArea" and "CONDITION_RedArea" The data from these needs to be converted within excel to columns in order to extract puncta areas. Data>Text to Columns and use the Delimited option, separated by Tabs. You should then get an individual column with the areas. Copy to Excel page where you can collect all puncta sizes for each condition in both green and red (separated by color of course) for statistical analysis, preferably within the "summary.xls" so all data for analysis is in one space.
	% Area Colocalized: These data are for the percent area of one signal colocalizing with the other. Results include gr_%AreaAvg(counted), gr_%AreaAvg(total), rg_%AreaAvg(counted), & rg_%AreaAvg(total). Counted vs Total is calculated based on the average % area covered either from the colocalized puncta population alone (%AreaAvg(counted)) or for all identified puncta (%AreaAvg(total)) These data are less frequently used for analysis
